---
  - name: Add contrib repos if Linux dist is Debian
    lineinfile: dest=/etc/apt/sources.list line="deb http://http.us.debian.org/debian stable main contrib"
    when: ansible_distribution == "Debian"

  - name: Add non-free repos if Linux dist is Debian
    lineinfile: dest=/etc/apt/sources.list line="deb http://http.us.debian.org/debian stable main contrib non-free"
    when: ansible_distribution == "Debian"

  - name: update apt cache
    apt: update_cache=yes
    tags: 
      - common
      - update_packages

  - name: install aptitude
    apt: pkg={{item}} state=present
    with_items:
      - aptitude
    tags:
      - common
      - packages

  - name: upgrade apt cache
    apt: upgrade=full
    tags: 
      - common
      - update_packages

  - name: install common packages
    apt: pkg={{item}} state=present
    with_items:
      - vim
      - htop
      - screen
      - git
      - unzip
      - sudo
      - tree
    tags: 
      - common
      - packages

  - name: Install Ubuntu mailutils
    apt: pkg={{item}} state=present
    with_items:
      - mailutils
    when: ansible_distribution == "Ubuntu"

  - name: change hostname
    hostname: name="{{ server_hostname }}"
    tags: common
    notify:
      - restart hostname

  - name: locale gen
    locale_gen: name={{ locale | default('en_GB.UTF-8') }} state=present
    tags:
      - common

  - name: Set locales
    template: src=../templates/locale.j2 dest=/etc/default/locale
    tags:
      - common